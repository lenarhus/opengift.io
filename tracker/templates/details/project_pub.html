{% extends "public/index.html" %}
{% load thumbnail get_settings compressed %}
{% block content %}
    {% compressed_css 'project_detail' %}
    <style>
        .small-text-label {
            padding: 3px 7px;
            font-size: 11px !important;
        }
    </style>
    <section class="u-py-100 u-h-100vh u-flex-center" style="
	background: #00cccc;
	background-image: -webkit-linear-gradient(left, #00cccc 0%, #39c2d3 100%);
	background-image: -o-linear-gradient(left, #00cccc 0%, #39c2d3 100%);
	background-image: -webkit-gradient(linear, left top, right top, from(#00cccc), to(#39c2d3));
	background-image: linear-gradient(to right, #00cccc 0%, #39c2d3 100%);
	background-repeat: repeat-x;
	filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FF8B3AC6', endColorstr='#FF4D3399', GradientType=1);
">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 u-mt-80">
                    <h1 class="display-4 u-fw-600 text-white u-mb-40">
                        {{ project.name }}
                        <sup class="small-text-label btn-red btn btn-sm btn-rounded">AI</sup>
                        <sup class="small-text-label btn-green btn btn-sm btn-rounded">PMI</sup>
                        <sup class="small-text-label btn-white btn btn-sm btn-rounded">ERP</sup>
                    </h1>
                    <p class="u-fs-22 text-white u-lh-1_8 u-mb-40">
                        {{ project.description }}
                    </p>
                    <a href="" class="btn btn btn-rounded btn-green  px-md-5">
                        Демо
                    </a>
                    <a href="" class="btn btn btn-rounded btn-white ml-3 px-md-5">
                        Помочь проекту
                    </a>
                </div> <!-- END col-lg-6-->
                <div class="col-lg-6 u-mt-80">
                    <ul class="p-0" data-init="carousel"
                        data-slick='{ "slidesToShow":1, "dots":true, "arrows":false, "dotsClass":"slick-dots dots-white mt-4 text-center"}'>
                        <li>
                            <img class="box-shadow-v1" src="/static/public/assets/img/seo/s-1.png" alt="">
                        </li>
                        <li>
                            <img class="box-shadow-v1" src="/static/public/assets/img/seo/s-1.png" alt="">
                        </li>
                        <li>
                            <img class="box-shadow-v1" src="/static/public/assets/img/seo/s-1.png" alt="">
                        </li>
                    </ul>
                </div> <!-- END col-lg-6-->
            </div> <!-- END row-->
        </div> <!-- END container-->
    </section> <!-- END intro-hero-->
    <section class="bg-gray-v1 u-py-100">
        <div class="container">
            <div class="row text-center">

                <div class="col-lg-3 col-md-6 u-my-20">
                    <div class="bg-white box-shadow-v1 u-ff-dosis u-py-40 rounded">
                        <h4 class="mb-0 u-fs-36 u-fw-400">
                            10M
                        </h4>
                        <p class="u-fs-20">
                            Скачиваний
                        </p>
                    </div>
                </div> <!-- END col-lg-3 col-md-6-->

                <div class="col-lg-3 col-md-6 u-my-20">
                    <div class="bg-white box-shadow-v1 u-ff-dosis u-py-40 rounded">
                        <h4 class="mb-0 u-fs-36 u-fw-400">
                            5000+
                        </h4>
                        <p class="u-fs-20">
                            Оценок
                        </p>
                    </div>
                </div> <!-- END col-lg-3 col-md-6-->

                <div class="col-lg-3 col-md-6 u-my-20">
                    <div class="bg-white box-shadow-v1 u-ff-dosis u-py-40 rounded">
                        <h4 class="mb-0 u-fs-36 u-fw-400">
                            265k
                        </h4>
                        <p class="u-fs-20">
                            Подписчиков
                        </p>
                    </div>
                </div> <!-- END col-lg-3 col-md-6-->

                <div class="col-lg-3 col-md-6 u-my-20">
                    <div class="bg-white box-shadow-v1 u-ff-dosis u-py-40 rounded">
                        <h4 class="mb-0 u-fs-36 u-fw-400">
                            128k
                        </h4>
                        <p class="u-fs-20">
                            Донейтов
                        </p>
                    </div>
                </div> <!-- END col-lg-3 col-md-6-->

            </div> <!-- END row-->
        </div> <!-- END container-->
    </section>

    <section class="u-py-100">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 m-auto text-center">
                    <h2 class="h1">
                        Метрики проекта
                    </h2>
                    <div class="u-h-4 u-w-50 bg-primary rounded mt-4 u-mb-40 mx-auto"></div>
                </div>
            </div>
            <div class="row">
                {% for chart in statistic.charts %}
                    <div class="col-md-6 mt-6" style="margin-bottom: 30px;">
                        <div class="card border-0 box-shadow-v1 u-h-100p">
                            <div class="u-p-30">
                                <h4>{{ chart.title }}</h4>
                                <canvas id="chart_{{ forloop.counter }}" width="400" height="400"></canvas>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
        <section>
            <div class="container">
                <div class="row">

                    <div class="col-12 text-center">
                        <h2 class="h1">
                            Команда проекта
                        </h2>
                        <div class="u-h-4 u-w-50 bg-primary rounded mx-auto mt-4 mb-5"></div>
                    </div> <!-- END col-12-->
                </div> <!-- END row-->

                <div class="row align-items-center">

                    {% for user in project.getUsers %}
                        {% if user.get_profile.avatarSrc %}
                            <div class="col-md-4 text-center mt-4">
                                <div class="p-5 mb-4 rounded bg-white text-center box-shadow-v3 u-h-100p">
                                    <img class="rounded-circle u-w-80 mx-auto u-mt-40 u-mb-20" src="{{ user.get_profile.avatarSrc }}" alt="">
                                    <h4 class="u-mb-5">
                                        {{ user.first_name }} {{ user.last_name }}
                                    </h4>
                                    <p class="text-muted">
                                        {{ user.get_profile.rating|floatformat }}
                                    </p>

                                    <p>
                                        {% for spec in user.get_profile.specialties.all %}<span>{{ spec.name }}</span>{% if not forloop.last %}, {% endif %}{% endfor %}
                                    </p>
                                    <ul class="list-inline social social-rounded social-default social-sm mt-4">
                                        <li class="list-inline-item">
                                            <a href=""><i class="fa fa-facebook"></i></a>
                                        </li>
                                        <li class="list-inline-item">
                                            <a href=""><i class="fa fa-twitter"></i></a>
                                        </li>
                                        <li class="list-inline-item">
                                            <a href=""><i class="fa fa-google-plus"></i></a>
                                        </li>
                                        <li class="list-inline-item">
                                            <a href=""><i class="fa fa-linkedin"></i></a>
                                        </li>
                                    </ul>
                                </div>
                            </div> <!-- END col-lg-6-->
                        {% endif %}
                    {% endfor %}
                </div> <!-- END row-->
            </div> <!-- END container-->
        </section>

        <script>
            $(function () {
                {% for chart in statistic.charts %}
                    var ctx = document.getElementById("chart_{{ forloop.counter }}").getContext('2d');
                    var mixedChart = new Chart(ctx, {
                        type: 'bar',

                        data: {
                            labels: [{% for event in chart.xAxe %}'{{ event.date|date:"m.Y" }}'{% if not forloop.last %}, {% endif %}{% endfor %}],
                            datasets: [
                                {% for y, axis in chart.yAxes.iteritems %}
                                    {
                                        label: "{{ axis.title }}",
                                        {% if forloop.last %}backgroundColor: "{{ axis.color }}",{% endif %}
                                        borderColor: "{{ axis.color }}",
                                        data: [{% for event in axis.values %}{{ event }}{% if not forloop.last %}, {% endif %}{% endfor %}]
                                        {% if not forloop.last %},type: 'line'{% endif %}
                                    }{% if not forloop.last %},{% endif %}
                                {% endfor %}
                            ]
                        },
                        options: {
                            legendCallback: function (chart) {
                                var text = [];
                                text.push('<ul class="' + chart.id + '-legend">');

                                var data = chart.data;
                                var datasets = data.datasets;
                                var labels = data.labels;
                                if (datasets.length == 1) return '';
                                if (datasets.length) {
                                    for (var i = 0; i < datasets[0].data.length; ++i) {
                                        text.push('<li><span style="background-color:' + datasets[0].backgroundColor[i] + '"></span>');
                                        if (labels[i]) {
                                            text.push(labels[i]);
                                        }
                                        text.push('</li>');
                                    }
                                }

                                text.push('</ul>');
                                return text.join('');
                            },
                            scales: {
                                xAxes: [{
                                    barPercentage: 0.2,
                                    categoryPercentage: 0.7
                                }],
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true
                                    }
                                }]
                            }
                        }
                    });
                {% endfor %}
            });
        </script>
    </section>
    <script>
        var getProjectState = function (p, call) {
            $.post('/blockchain/ajax/', {'action': 'getProjectStatus', 'pName': p}, function (data) {
                if (data == 'ok')
                    call();
            });
        };
        $(function () {
            getProjectState('{{ project.name }}', function () {
                $('.js-donate').show();
            });
        })
    </script>
    <script type="application/javascript" src="/static/js/libs/charts.2.7.1.js"></script>
{% endblock %}
